

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>7. GAP interface &mdash; Pyfas 0.2.3 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Pyfas 0.2.3 documentation" href="../index.html"/>
        <link rel="next" title="8. SFC interface" href="SFC_interface.html"/>
        <link rel="prev" title="6. Tab files" href="Tab_files.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Pyfas
          

          
          </a>

          
            
            
              <div class="version">
                0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">1. Introduction to Pyfas</a></li>
<li class="toctree-l1"><a class="reference internal" href="Introduction.html#Installation">2. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="OLGA_tpl.html">3. OLGA tpl files, examples and howto</a></li>
<li class="toctree-l1"><a class="reference internal" href="OLGA_ppl.html">4. OLGA ppl files, examples and howto</a></li>
<li class="toctree-l1"><a class="reference internal" href="Unisim_usc.html">5. Unisim usc files</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tab_files.html">6. Tab files</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">7. GAP interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="SFC_interface.html">8. SFC interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="utilities.html">9. Utilities</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Pyfas</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>7. GAP interface</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/notebooks/GAP_interface.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="GAP-interface">
<h1>7. GAP interface<a class="headerlink" href="#GAP-interface" title="Permalink to this headline">¶</a></h1>
<p>GAP provides a comfortable set of API via the OpenServer interface. This
interface works, of course, only on Windows and provides a CLI access to
most of the simulator features. <code class="docutils literal notranslate"><span class="pre">Pyfas</span></code> is not required to use
OpenServer.</p>
<p>This example uses pywin32, but any package providing a COM interface
should work:</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">Connecting</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">open</span> <span class="pre">GAP</span> <span class="pre">file</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">win32com.client</span> <span class="pre">import</span> <span class="pre">Dispatch</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">gap</span> <span class="pre">=</span> <span class="pre">Dispatch('PX32.OpenServer.1')</span></code></div>
</div>
<div class="line-block">
<div class="line">The previous command gives the possibility to interact with an open
GAP model (open via the UI). In case more than one model is open, the
last one opened is considered.</div>
<div class="line">It is also possible to access to closed models:</div>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">gap.docommand('GAP.START')</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">gap.docommand(r'GAP.OpenFile(&quot;C:\example\example.gap&quot;)')</span></code></div>
</div>
<p>Two basic operations are possible:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">getvalue</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">setvalue</span></code></li>
</ul>
<p>Pretty straightforward, isn’t it?</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">This</span> <span class="pre">command</span> <span class="pre">shows</span> <span class="pre">the</span> <span class="pre">flow</span> <span class="pre">correlation</span> <span class="pre">for</span> <span class="pre">the</span> <span class="pre">Pipe1</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">model</span> <span class="pre">{PROD}</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">gap.getvalue(&quot;GAP.MOD[{PROD}].PIPE[1].PIPECORR&quot;)</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">Out[4]:</span> <span class="pre">'MukerjeeBrill'</span></code></div>
</div>
<p>To set a value instead:</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">This</span> <span class="pre">command</span> <span class="pre">sets</span> <span class="pre">the</span> <span class="pre">flowrate</span> <span class="pre">of</span> <span class="pre">SOURCE1</span> <span class="pre">to</span> <span class="pre">10</span> <span class="pre">(it</span> <span class="pre">uses</span> <span class="pre">predefined</span> <span class="pre">unit)</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">gap.setvalue(&quot;GAP.MOD[{PROD}].SOURCE[{Source1}].Rate&quot;,</span> <span class="pre">10)</span></code></div>
</div>
<p>It looks complicated but a good reference guide is available and, even
better, with the right click in the GUI the corresponding <code class="docutils literal notranslate"><span class="pre">OpenServer</span></code>
command can be showed in the <code class="docutils literal notranslate"><span class="pre">OpenServer</span></code> window:</p>
<div class="figure">
<img alt="" src="../_images/openserver.png" />
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="SFC_interface.html" class="btn btn-neutral float-right" title="8. SFC interface" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Tab_files.html" class="btn btn-neutral" title="6. Tab files" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Giuseppe Pagliuca.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.2.3',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>